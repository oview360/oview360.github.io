function Oview48(t,e,n,i){function o(){Me=S.offsetWidth,Te=S.offsetHeight,j=ye/Me,$&&(Ee=$/Me),ve>1?T(1,10):xe?F():E(1,10)}function a(t,e){return"https://s3-ap-southeast-1.amazonaws.com/oview360/pic/"+X+"/"+X+t+"/"+String("000"+e).slice(-3)+".jpg"}function s(){ge=36,ne.innerHTML="",te.style.opacity="";var t=ue[ge];ye=t.naturalWidth,we=t.naturalHeight,j=ye/Me,r(t),H(!1,12,66),setTimeout(function(){ee.addEventListener("mousedown",h),ee.addEventListener("touchstart",h),ee.addEventListener("dblclick",v),ee.addEventListener("mousewheel",b),ee.addEventListener("DOMMouseScroll",x),ee.addEventListener("contextmenu",M),ie.style.opacity=.2,ie.className="blink",oe.style.bottom="0"},600),setTimeout(function(){B=!0},2e3)}function r(t){t.naturalWidth&&(se.width=t.naturalWidth,se.height=t.naturalHeight,re.drawImage(t,0,0))}function c(){B&&(B=!1,setTimeout(function(){ie.style.opacity=0,ie.className=""},200))}function u(){_&&clearTimeout(_)}function d(t){K*K+Q*Q>t&&u()}function l(t,e){e&&(K=t.pageX-G,Q=t.pageY-J),G=t.pageX,J=t.pageY}function h(t){if(pe)if(K=0,Q=0,fe=!1,me=ge+.5,null==t.touches)t.preventDefault(),l(t,!1),_=setTimeout(v,1400,t),document.addEventListener("mousemove",p),document.addEventListener("mouseup",f);else if(t.touches.length<=2){if(1==t.touches.length){var e=t.targetTouches[0];l(e,!1),Z=0,_=setTimeout(v,1400,e)}else{var e=t.targetTouches[0],n=t.targetTouches[1],i=n.pageX-e.pageX,o=n.pageY-e.pageY;G=.5*(e.pageX+n.pageX),J=.5*(e.pageY+n.pageY),Z=Math.sqrt(i*i+o*o),u()}document.addEventListener("touchmove",p),document.addEventListener("touchend",f)}else u()}function p(t){if(null==t.touches)l(t,!0),d(2),m();else if(1==t.touches.length){t.preventDefault();var e=t.targetTouches[0];l(e,!0),d(12),m()}else if(2==t.touches.length){t.preventDefault();var e=t.targetTouches[0],n=t.targetTouches[1],i=.5*(e.pageX+n.pageX),o=.5*(e.pageY+n.pageY),a=n.pageX-e.pageX,s=n.pageY-e.pageY;K=i-G,Q=o-J,G=i,J=o,V=Math.sqrt(a*a+s*s),4*(V-Z)*(V-Z)>K*K+Q*Q?(be=ve*(V/Z),V>Z?be>1.5*Ee&&(be=1.5*Ee):.96>be&&(be=.96),T(be,1)):m(),Z=V}}function f(t){u(),null==t.touches?(this.removeEventListener("mousemove",p),this.removeEventListener("mouseup",f)):(this.removeEventListener("touchmove",p),this.removeEventListener("touchend",f)),1==ve?xe?F():Math.abs(K)>9&&Math.abs(K)>Math.abs(Q)?H(0>K,1e3,Math.abs(1200/K)):Math.abs(Q)>9&&Math.abs(Q)>Math.abs(K)&&(pe=!1,H(0>Q,Math.floor(24),12)):w()}function m(){ve>1?L():xe?F():Q*Q>3*K*K?window.scrollTo(0,window.scrollY-Q):C()}function g(t,e){var n=Math.floor(Math.floor(t/e)*e*(1+e)/e)*e;return n>Ee?Ee:n}function v(t){l(t,!1),Ee>ve?T(g(ve,.5),400):T(1,800)}function b(t){t.preventDefault(),pe&&(l(t,!1),y(.002*t.wheelDelta))}function x(t){t.preventDefault(),pe&&(l(t,!1),y(.08*-t.detail))}function y(t){u(),O&&clearTimeout(O),V=t,Z=Math.abs(t),Z>1&&(Z=1),V>0?(be=ve*(1+Z),be>1.5*Ee&&(be=1.5*Ee)):(be=ve/(1+Z),.96>be&&(be=.96)),T(be,400*Z),O=setTimeout(w,400)}function w(){1.12>ve?T(1,400):ve>Ee&&T(Ee,400)}function M(){u(),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",f)}function T(t,e,n){if(fe=!1,xe&&F(),ve!=t){if(pe=!1,c(),1==t)R=0,U=0;else{var i=t/ve,o=G-S.offsetLeft,s=J-S.offsetTop;R=(o-te.offsetLeft)*i-o,U=(s-te.offsetTop)*i-s}if(E(t,e),q=setTimeout(function(){te.style.transition=""},e),ve=t,1>=ve)ne.innerHTML="",se.width!=ye&&r(ue[ge]);else if(se.width==ye){if(ve>1.2){var u=de[ge];u?u.complete&&r(u):(de[ge]=new Image,u=de[ge],u.src=a("-p1800",ge+1),u.setAttribute("n",ge),u.onload=function(){const t=parseInt(this.getAttribute("n"));t==ge&&ve>1.2&&(ne.innerHTML="",r(this)),void 0==$&&($=this.naturalWidth,Ee=$/Me)})}1.6>ve?""!=ne.innerHTML&&(ne.innerHTML=""):ve>1.9&&""==ne.innerHTML&&(ne.innerHTML=A)}n||setTimeout(function(){pe=!0},e)}}function L(){0>K?R+=64+4096/(K-64):R-=64-4096/(K+64),0>Q?U+=64+4096/(Q-64):U-=64-4096/(Q+64),E(ve)}function E(t,e){var n=(t-1)*Me,i=(t-1)*Te;t>=1?(0>R?R=0:R>n&&(R=n),0>U?U=0:U>i&&(U=i)):(R>0?R=0:n>R&&(R=n),U>0?U=0:i>U&&(U=i)),e&&(q&&clearTimeout(q),te.style.transition="all "+.001*e+"s",te.style.width=Math.round(Me*t)+"px",te.style.height=Math.round(Te*t)+"px"),te.style.left=Math.round(-R)+"px",te.style.top=Math.round(-U)+"px"}function C(){0>K?me-=1+10/(K-10):me+=1-10/(K+10),me>=I?me%=I:0>me&&(me=I+me%I),k(Math.floor(me))}function k(t){t!=ge&&(c(),ue[t].naturalWidth&&ue[t].complete&&re.drawImage(ue[t],0,0),ge=t)}function H(t,e,n,i){fe=!0,setTimeout(function(){t?(0==ge&&(ge=I),k(ge-1)):(47==ge&&(ge=-1),k(ge+1)),n=99>n?1.09*n:99,e>1?fe&&H(t,e-1,n,i):(fe=!1,i?z(i):pe=!0)},Math.round(n))}function z(t){var e=document.createElement("div"),n=le[t],i=n.r,o=n.x,a=n.y,s=n.info,r=0;.05>i?i=.05:i>.2&&(i=.2);const c=Math.round(i*Le),u=Math.round(o*Me),d=Math.round(a*Te),l=(20*(1-j)*i+4*j-1)/3,h=Me*(l-1),p=Te*(l-1);var f=te.firstChild,m=f.cloneNode();ctx=m.getContext("2d"),te.appendChild(m),ctx.save(),ctx.beginPath(),ctx.arc(u*j,d*j,c*j,0,2*Math.PI),ctx.clip(),ctx.drawImage(f,0,0),ctx.restore(),ctx.lineWidth=4*j/l,ctx.strokeStyle="rgba(255,255,255,.5)",ctx.stroke(),f.style.cssText+="-webkit-filter:blur(8px) invert(15%);filter:blur(8px) invert(15%)",R=h*o,U=p*a,o>.5?(r=l*(Me-u-c),h-R>r&&(R=h)):(r=l*(u-c),R>r&&(R=r)),a>.5?(r=l*(Te-d-c),p-U>r&&(U=p)):(r=l*(d-c),U>r&&(U=r)),E(l,1600),e.className="eigenPtInfo",S.appendChild(e),e.innerHTML=s,b_high=a>.5?l*(d-c)-U:Te+U-l*(d+c),r=b_high-e.offsetHeight-18,12>r?(a>.5?e.style.top="0":e.style.bottom="0",e.style.height=b_high-18+"px",e.style.overflowY="scroll"):a>.5?e.style.top=r+"px":e.style.bottom=r+"px",e.style.left=o*(Me-e.offsetWidth)+"px",setTimeout(function(){pe=!0},500)}function F(){E(1,600),te.childElementCount>1&&(te.lastChild.remove(),te.firstChild.style.cssText=D,xe=0),S.childElementCount>4&&S.lastChild.remove(),oe.style.bottom="0"}const P=!!("ontouchstart"in window),Y=navigator.language,I=48,X=e,W='<svg viewBox="0 0 128 128"><circle fill="#FFF" cx="64" cy="64" r="64"/><path fill="#AAA" d="M109.6,49c0-10.5-1.7-20.6-4.8-30c0,0.1,0,0.2,0,0.3c0,4.4-1.6,8.5-4.3,11.6c-1.6-1.3-3.3-2.3-5.2-3.1C87,20.4,76,16,64,16s-23,4.4-31.4,11.7c-1.9,0.8-3.6,1.9-5.2,3.1c-2.7-3.1-4.3-7.2-4.3-11.6c0-0.1,0-0.2,0-0.3c-3.1,9.5-4.8,19.5-4.8,30c-1.6,4.7-2.4,9.8-2.4,15c0,26.5,21.5,48,48,48s48-21.5,48-48C112,58.8,111.2,53.7,109.6,49z M42.4,67.6c-9.9,0-18-8.1-18-18s8.1-18,18-18s18,8.1,18,18S52.3,67.6,42.4,67.6z M64,76.4c-2.4-2.5-4.4-5.5-5.9-8.7c2.4-2.1,4.4-4.7,5.9-7.6c1.4,2.9,3.4,5.5,5.9,7.6C68.4,71,66.4,73.9,64,76.4z M85.6,67.6c-9.9,0-18-8.1-18-18s8.1-18,18-18s18,8.1,18,18S95.5,67.6,85.6,67.6z"/></svg>',A='<svg viewBox="0 0 96 96"><circle cx="48" cy="48" fill="#BBB"><animate attributeName="r" from="6" to="48" dur="1.5s" repeatCount="indefinite"/><animate attributeName="opacity" from=".8" to="0" dur="1.5s" repeatCount="indefinite"/></circle></svg>',D="position:absolute;width:100%;height:100%;",N=P?["滑動進行 360° 觀看<br>雙指外撥以放大檢視","Swipe for a 360° view<br>Pinch out to zoom in"]:["拖曳進行 360° 觀看<br>向上捲動以放大檢視","Drag for a 360° view<br>Scroll up to zoom in"];var S=document.getElementById(t);S.style.cssText="position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;max-width:"+50*S.firstElementChild.width+"px;text-align:center;font:18px Helvetica,STHeiti,sans-serif;";var B,_,O,q,j,G,J,K,Q,R,U,V,Z,$,te=document.createElement("div"),ee=document.createElement("div"),ne=document.createElement("div"),ie=document.createElement("p"),oe=document.createElement("div"),ae=document.createElement("a"),se=document.createElement("canvas"),re=se.getContext("2d"),ce=document.createElement("style"),ue=new Array(I),de=new Array(I),le=[0],he=[],pe=!1,fe=!1,me=0,ge=0,ve=1,be=1,xe=0,ye=0,we=0,Me=S.offsetWidth,Te=S.offsetHeight,Le=Math.max(Me,Te),Ee=3;S.appendChild(ee),ee.appendChild(ne),ee.appendChild(ie),S.appendChild(oe),S.appendChild(te),te.appendChild(se),ne.style.top=.5*Te-48+"px",ne.innerHTML=A,ie.innerHTML=0==Y.indexOf("zh")?N[0]:N[1],te.style.cssText=D+"left:0;top:0;text-align:left;opacity:.1;transition:opacity 1s",se.style.cssText=D,oe.style.bottom="-44px",oe.className="dashPod",ee.className="ctrLayer",ce.innerHTML=".ctrLayer{position:absolute;top:0;width:100%;height:100%;z-index:2;cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}.ctrLayer:active{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}.ctrLayer>div{position:relative;width:96px;height:96px;margin:auto;pointer-events:none}.ctrLayer p{position:absolute;top:0;width:100%;margin:0;padding:8px 0;opacity:0;background:#FFF;font-size:16px;transition:opacity 1s}.blink{animation:blink 4s infinite ease-in 1s;-webkit-animation:blink 4s infinite ease-in 1s}@keyframes blink{0%{opacity:.2}50%{opacity:.6}100%{opacity:.2}}@-webkit-keyframes blink{0%{opacity:.2}50%{opacity:.6}100%{opacity:.2}}.dashPod{position:absolute;width:100%;height:40px;opacity:.4;z-index:3;pointer-events:none;transition:bottom .6s}.dashPod:hover{opacity:.7}.dashPod>div{pointer-events:auto;cursor:pointer;float:left}.dashPod>div:first-child{margin-left:8px}.dashPod>div>p{width:10px;height:10px;background:rgba(128,128,128,.2);border-radius:50%;border:2px solid #FFF;box-shadow:0 2px 5px #999;margin:13px}.dashPod>div:hover>p{background:#FFF}.dashPod>a{pointer-events:auto;position:absolute;right:6px;width:36px;height:36px}.eigenPtInfo{position:absolute;box-sizing:border-box;border-radius:12px;max-width:70%;z-index:5;padding:10px;color:#222;text-shadow:0 1px 7px #FFF;background:rgba(255,255,255,.5)}",document.head.appendChild(ce),n.length>5&&(n=n.slice(0,5)),le=le.concat(n);const Ce=le.length-1;if(Ce>0)for(var ke=0;Ce>ke;ke++)he[ke]=document.createElement("div"),he[ke].id=ke+1,he[ke].appendChild(document.createElement("p")),oe.appendChild(he[ke]),he[ke].onclick=function(){S.focusPoint(this.id)};return i&&(ae.innerHTML=W,ae.href=i,ae.setAttribute("target","_blank"),oe.appendChild(ae)),window.addEventListener("resize",o),S.run=function(){function t(t,i,o,s){for(;n[t]!=i;n[t]++)ue[n[t]]=new Image,ue[n[t]].src=a("-p900",n[t]+1),ue[n[t]].onload=function(){e[t]++,e[t]==o&&s()}}var e=[0,0,0,0],n=[36,0,10,24];t(0,48,10,function(){t(1,10,9,function(){s(),setTimeout(function(){t(2,24,12,function(){t(3,36,11,function(){ye||s()})})},800)})})},S.focusPoint=function(t){fe=!1,pe=!1,oe.style.bottom="-44px";const e=le[t].n-1,n=ve-1;setTimeout(function(){if(T(1,400*n,!0),e==ge)setTimeout(function(){z(t)},408*n);else{var i=e-ge;2*Math.abs(i)>I&&(i=0>i?i+I:i-I);var o=Math.abs(i),a=400*n-72*o-72;0>a&&(a=0),setTimeout(function(){H(0>i,o,64-2*o,t)},a)}xe=t},104)},S}